<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="知道自己想要做什么,比怎么做更重要">
    

    <!--Author-->
    
        <meta name="author" content="klion">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="klion&#39;s blog"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="知道自己想要做什么,比怎么做更重要" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="klion&#39;s blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>page - klion&#39;s blog</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    主页
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    所有文章
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about">
                    关于自己
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    标签
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    分类
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact">
                    一起交流
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
            <h1 id="main-title" class="title">klion's blog</h1>
        
    </div>
</header>

        <section class="main">
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/23/time-tasks/">
                win计划任务小记
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-23</span>
            
            
            
                <span class="category">
                    <a href="/categories/schtasks/">schtasks</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h4 id="1-关于系统计划任务的一些简单使用-03以前的系统中可使用-at-来执行各种系统计划任务"><a href="#1-关于系统计划任务的一些简单使用-03以前的系统中可使用-at-来执行各种系统计划任务" class="headerlink" title="1,关于系统计划任务的一些简单使用,03以前的系统中可使用 at 来执行各种系统计划任务"></a>1,关于系统计划任务的一些简单使用,03以前的系统中可使用 at 来执行各种系统计划任务</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># at 14:23 /every:18,19,21,24,28 c:\shell.exe  创建本地计划任务,每月的这几号的这个点执行指定的可执行程序</span></div><div class="line"><span class="comment"># at /delete /y 	删除本地所有的计划任务</span></div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># at \\192.168.3.23 14:23 /every:18,19,21,24,28 c:\shell.exe 在远程机器上创建计划任务</span></div><div class="line"><span class="comment"># at \\192.168.3.23 /delete /y 删除远程机器上的所有的计划任务</span></div></pre></td></tr></table></figure>
        </div>
        <a href="/2016/09/23/time-tasks/" class="read-more">Read More</a>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/22/strace/">
                利用strace来跟踪在ssh时输入的密码
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-22</span>
            
            
            
                <span class="category">
                    <a href="/categories/strace/">strace</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h5 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h5><p>strace本身其实是一个非常好用的系统调用跟踪工具,运维们可以通过它快速锁定问题的根源,但,恰巧我们也可以通过这种方式来跟踪任何进程数据,比如ssh,su,sudo,这里以跟踪密码为例,大家可以自行脑洞更多其它用法,关于strace自身的选项作用,请man:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># yum install strace 如果目标机器没有装strace,那你就自己顺手给他装一个,不过像这类的调试工具,一般都会作为常用工具而被预装</span></div><div class="line"><span class="comment"># vi ~/.bashrc 注意,这里是当前用户的环境变量配置文件,也就是说它只能对当前用户有效,不过你也可以加到全局配置中 '/etc/bashrc'</span></div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">alias</span> ssh=<span class="string">'strace -o /tmp/.sshpwd-`date '</span>+%d%h%m%s<span class="string">'`.log -s 2048 ssh'</span></div></pre></td></tr></table></figure>
        </div>
        <a href="/2016/09/22/strace/" class="read-more">Read More</a>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/21/ssh-portforward/">
                通向彼岸 之内网代理转发 [ ssh正反向转发及socks代理篇 ]
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-21</span>
            
            
            
                <span class="category">
                    <a href="/categories/ssh-portforwd/">ssh portforwd</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h5 id="ssh端口转发-可以连续转发多个端口-这里只以转单个端口为例"><a href="#ssh端口转发-可以连续转发多个端口-这里只以转单个端口为例" class="headerlink" title="ssh端口转发(可以连续转发多个端口,这里只以转单个端口为例):"></a>ssh端口转发(可以连续转发多个端口,这里只以转单个端口为例):</h5><p><br></p>
<h5 id="ssh-命令选项作用简介-更多选项详情-请自行man-ssh-那里面确实说的非常详细"><a href="#ssh-命令选项作用简介-更多选项详情-请自行man-ssh-那里面确实说的非常详细" class="headerlink" title="ssh 命令选项作用简介[更多选项详情,请自行man ssh,那里面确实说的非常详细]:"></a>ssh 命令选项作用简介[更多选项详情,请自行man ssh,那里面确实说的非常详细]:</h5><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">-C  压缩数据传输,加快传输速度</div><div class="line">-f  后台登录用户名密码</div><div class="line">-n  后台运行</div><div class="line">-q  安静模式,不要显示警告等信息</div><div class="line">-l  指定登录名</div><div class="line">-N  不执行shell通,主要用在转发中</div><div class="line">-g  允许远程主机连接到本地转发的端口     </div><div class="line">-L  本地端口转发</div><div class="line">-R  远程端口转发</div><div class="line">-D  socks代理</div><div class="line">-T  禁止分配伪终端</div><div class="line">-p  指定远程ssh 端口</div></pre></td></tr></table></figure>
        </div>
        <a href="/2016/09/21/ssh-portforward/" class="read-more">Read More</a>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/20/fpipe-redirect-port/">
                通向彼岸 之内网代理转发 [ 利用端口重定向bypass各类应用层防火墙 fpipe ]
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-20</span>
            
            
            
                <span class="category">
                    <a href="/categories/fpipe/">fpipe</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h5 id="前言"><a href="#前言" class="headerlink" title="前言:"></a>前言:</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;如果你觉得netsh和iptables配置稍微有点儿繁琐,有款小工具可能会适合你,fpipe 一款专门用于端口重定向的小工具,从名字就能猜出来它是干啥的,很明显,forward pipe[转发,通过管道],虽然功能上和netsh有一点点类似,但确实不是一类东西,同样是监听来自外部的某个端口,但它多做了一步,它会把来自外部端口的流量先转到本地某个指定的端口上(转发),再通过转到的这个本地端口去连远程机器的某个端口(管道),而不是像netsh只是单纯的把端口转过去,简易的通信流程如下</p>
<p>外部端口访问 &lt;-&gt; 本地监听来自外部的这个端口并它转到本地的另一个端口上(在本地绑定两个端口) &lt;-&gt; 通过本地的另一个端口和远程机器的某个端口通信 </p>
<p>工具选项如下,非常简单,看选项说明就懂了:<br><img src="/img/fpipe help.png" alt=""><br></p>
<p>1,我们可以拿它来做什么<br>&nbsp;&nbsp;&nbsp;&nbsp;刚刚在上面已经说过,它并非直接转发,而是又自己建立了一个新的通道,这样的好处在哪里呢,很明显,我们可以通过这样的方式来轻松bypass掉各类应用层防火墙<br>
        </div>
        <a href="/2016/09/20/fpipe-redirect-port/" class="read-more">Read More</a>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/19/iptables-portfward/">
                通向彼岸 之内网代理转发 [ 系统篇 iptables ]
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-19</span>
            
            
            
                <span class="category">
                    <a href="/categories/iptabbles/">iptabbles</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h4 id="作用和netsh差不多-这里就不废话了-直接看操作-还是同样的情况-只不过你此时拿下的是边界的一台linux服务器-依然想通过这台机器直接去访问内网的其它机器"><a href="#作用和netsh差不多-这里就不废话了-直接看操作-还是同样的情况-只不过你此时拿下的是边界的一台linux服务器-依然想通过这台机器直接去访问内网的其它机器" class="headerlink" title="作用和netsh差不多,这里就不废话了,直接看操作,还是同样的情况,只不过你此时拿下的是边界的一台linux服务器,依然想通过这台机器直接去访问内网的其它机器"></a>作用和netsh差不多,这里就不废话了,直接看操作,还是同样的情况,只不过你此时拿下的是边界的一台linux服务器,依然想通过这台机器直接去访问内网的其它机器</h4><p><br></p>
<p>1,环境大致如下:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">边界linux机器(centos <span class="number">6.8</span>en) <span class="symbol">ip:</span><span class="number">192.168</span>.<span class="number">3.40</span>(假设为目标机器的公网ip) <span class="number">192.168</span>.<span class="number">32.129</span>(假设为目标的内网ip) </div><div class="line">要访问的内网windows机器(win <span class="number">2008</span>r2cn) <span class="symbol">ip:</span><span class="number">192.168</span>.<span class="number">32.134</span> </div><div class="line">攻击者机器(win7cn): <span class="number">192.168</span>.<span class="number">3.251</span></div></pre></td></tr></table></figure></p>
<p>2,最终目的<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">通过边界的linux机器访问内网中的windows机器上的服务</div></pre></td></tr></table></figure></p>
<p>3,具体过程如下,首先,编辑边界linux系统的路由转发配置文件,开启其路由转发功能<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># sed -i '/net.ipv4.ip_forward/ s/\(.*= \).*/\11/' /etc/sysctl.conf</span></div><div class="line"><span class="comment"># cat /etc/sysctl.conf | grep "net.ipv4.ip_forward"</span></div></pre></td></tr></table></figure></p>
        </div>
        <a href="/2016/09/19/iptables-portfward/" class="read-more">Read More</a>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/18/netsh-portfward/">
                通向彼岸 之内网代理转发 [ 系统篇 netsh ]
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/netsh/">netsh</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h4 id="前言"><a href="#前言" class="headerlink" title="前言:"></a>前言:</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;除了前面提到的用一些端口转发工具来进行端口转发,其实windows系统自己也给我们提供了类似的功能,比如,其自带的防火墙管理工具’netsh’套件(确实非常实用),尤其碰到一些稍微畸形点的内网环境:<br><br></p>
<p>1,先来假设这么一种情况<br>&nbsp;&nbsp;&nbsp;&nbsp;当你搞定边界的一台windows机器以后,上去一看发现,机器上有两块网卡,一块外网卡,一块内网卡(先以正常的DMZ来讲),这时又你通过别的方式搞定了同内网的另一台windows机器,本来以为简单的种上马就可以走人了,但你发现马执行以后似乎什么都没发生,搞了半天,你才发现,原来这台内网机器根本不能连外网,说到这里,相必你也应该知道我要干啥了,没错,虽然内网的那台机器不能连外网,但它起码能跟边界的这台机器正常通信,这就够了,我们可以直接从外部通过边界这台机器来访问内网的那台不能连外网的机器<br><br><br>2,演示简单环境如下<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">目标的边界机器(win7en) <span class="symbol">ip:</span> <span class="number">192.168</span>.<span class="number">3.212</span>(假设为目标公网ip,这台机器没有任何服务,就是台个人机,rdp和telnet当然也不会开了) <span class="number">192.168</span>.<span class="number">32.132</span>(目标内网ip)</div><div class="line">目标内网的那台不能连外网的机器(win <span class="number">2008</span>r2cn) <span class="symbol">ip:</span><span class="number">192.168</span>.<span class="number">32.134</span>(目标内网ip)</div><div class="line">外部的攻击者的机器(win7cn) <span class="symbol">ip:</span><span class="number">192.168</span>.<span class="number">3.251</span></div></pre></td></tr></table></figure></p>
<p>3,要实现的目的很简单:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">首先,可以确认的是,边界机器和攻击者机器通信正常,边界机器和目标内网的那台不能连外网的机器通信正常</div><div class="line">现在,我想通过边界机器的某个端口去访问目标内网的那台不能上外网的机器的<span class="number">3389</span>,下面是具体的操作步骤</div></pre></td></tr></table></figure></p>
        </div>
        <a href="/2016/09/18/netsh-portfward/" class="read-more">Read More</a>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/16/http-tunnel-question/">
                通向彼岸 之内网代理转发 [ http隧道篇 使用过程中容易出现的一些问题 ]
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-16</span>
            
            
            
                <span class="category">
                    <a href="/categories/http-tunnel/">http tunnel</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h5 id="关于使用http隧道代理脚本时-容易出现的一些错误及解决办法"><a href="#关于使用http隧道代理脚本时-容易出现的一些错误及解决办法" class="headerlink" title="关于使用http隧道代理脚本时,容易出现的一些错误及解决办法:"></a>关于使用http隧道代理脚本时,容易出现的一些错误及解决办法:</h5><p>1,如果是php程序,你可能需要先确保php.ini中的socket模块已正常开启并且可用,因为php中的socket函数要基于此模块,不过,reGeorg早已经提供了不再需要开启socket的代理脚本<br>2,有时候你在绑定某些端口会遇到socket无法建立连接的问题,不妨尝试换一下端口,比如:53,8080,443,只要不跟目标系统中的现有端口冲突即可,尽量用一些穿透性比较好的端口<br>3,有时还会遇到aspx 运行错误,看具体是什么错误,如果一眼解决不了,谷歌一下,里面肯定一大堆,比如:’Compilation Error’,可以尝试在代理脚本(webshell)的当前所在目录,另外新建一个web.conf文件,一般也即可解决,文件具体内容如下:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;configuration&gt;</div><div class="line">  &lt;system.web&gt;</div><div class="line">  &lt;customErrors mode="Off"/&gt;</div><div class="line">  &lt;/system.web&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure></p>
        </div>
        <a href="/2016/09/16/http-tunnel-question/" class="read-more">Read More</a>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2016/09/15/abptts-http-tunnel/">
                通向彼岸 之内网代理转发 [ http隧道篇 abptts ]
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-09-15</span>
            
            
            
                <span class="category">
                    <a href="/categories/http-tunnel/">http tunnel</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><br></p>
<h4 id="前言"><a href="#前言" class="headerlink" title="前言:"></a>前言:</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;abptts 一款基于简单传输加密的http隧道工具,实际测试中相对来说还算比较稳定,起码比regerog都要稳定一些,且全程通信数据加密,可一定程度上对抗取证检测,就单这一点来说,还是很赞的,不过,加不加密,它自己说的不算,还是老办法,拿wireshark耐心的走一遍,就明白了,尽量用事实说话嘛<br><br><br>1,首先,安装好工具所需的各种py依赖库:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> pip install pycrypto    加密库,整个数据加密都要靠这个</span></div><div class="line"><span class="meta">#</span><span class="bash"> pip install httplib2</span></div></pre></td></tr></table></figure></p>
        </div>
        <a href="/2016/09/15/abptts-http-tunnel/" class="read-more">Read More</a>
    

</div>
            
        </section>
    </div>
</div>



    <div class="row">
        <div class="col-sm-12">
            <div class="wrap-pagination">
                <a class="" href="/page/3/">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </a>
                <a class="" href="/page/5/">
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>




</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/klionsec">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:klionsec@gmail.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    <h2>blog by klion</h2>
                </div>
            </div>
        </div>
    </div>
</footer>


<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>